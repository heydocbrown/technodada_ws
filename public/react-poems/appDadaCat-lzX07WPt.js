import{r as t,j as e,R as v,a as E}from"./App-B9regU7K.js";import{P as I,I as T}from"./ImageViewer-C2Gju3NJ.js";const b="https://f005.backblazeb2.com/file/td-website/index.json";function R({onArtSelect:n}){const[r,j]=t.useState([]),[d,m]=t.useState([]),[u,i]=t.useState([]),[N,c]=t.useState({}),[g,o]=t.useState(!0),[p,S]=t.useState(null);t.useEffect(()=>{A()},[]),t.useEffect(()=>{if(r.length>0){console.log("Filtering for dadacat with human_prompt"),console.log("Total artData items:",r.length);const s=r.filter(l=>l.artproject==="dadacat"&&l.on_website==="yes"&&l.human_prompt&&l.human_prompt.trim()!=="");console.log("Filtered items with human_prompt:",s.length);const a={};s.forEach(l=>{const x=l.human_prompt.trim();a[x]||(a[x]=[]),a[x].push(l)});const h=Object.keys(a).sort();console.log("Unique human_prompts:",h.length),console.log("Prompt mapping:",a),m(s),i(h),c(a)}else m([]),i([]),c({})},[r]);const A=async()=>{try{o(!0);const s=await fetch(b);if(!s.ok)throw new Error("Failed to fetch art data");const h=(await s.json()).images||[];j(h),o(!1)}catch(s){console.error("Error fetching art data:",s),S("REALITY_FETCH_ERROR: Unable to retrieve dadacat visions"),o(!1)}},f=s=>{const a=s.target.value;if(a&&N[a]){const h=N[a],l=Math.floor(Math.random()*h.length),x=h[l];console.log(`Selected prompt: "${a}" has ${h.length} items, chose index ${l}`),x&&n(x)}};return g?e.jsx("div",{className:"art-selector-section",children:e.jsxs("div",{className:"terminal-window",children:[e.jsxs("div",{className:"terminal-header",children:["> LOADING DADACAT_DATABASE...",e.jsx("br",{}),"> ESTABLISHING BACKBLAZE_CONNECTION..."]}),e.jsx("div",{className:"terminal-body",children:e.jsx("div",{className:"loading",children:"SCANNING DADACAT_FRAGMENTS"})})]})}):p?e.jsx("div",{className:"art-selector-section",children:e.jsx("div",{className:"terminal-window",children:e.jsx("div",{className:"terminal-header error-message",children:p})})}):e.jsx("div",{className:"art-selector-section",children:e.jsx("div",{className:"dropdown-container",children:e.jsxs("select",{className:"art-dropdown",onChange:f,defaultValue:"",children:[e.jsxs("option",{value:"",children:["> SELECT DADACAT VISION [",u.length," UNIQUE PROMPTS]"]}),u.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})})})}function _({onGenerate:n}){const[r,j]=t.useState(""),[d,m]=t.useState(!1),[u,i]=t.useState(null),N=async c=>{if(c.preventDefault(),!!r.trim()){m(!0),i(null);try{const o=await fetch("/api/dadacat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r.trim()})});if(!o.ok)throw new Error(`Server error: ${o.status}`);const p=await o.json();n({human_prompt:r,cleaned_prompt:p.dadacat_response,image_url:p.image_url,backblaze_path:p.backblaze_path,run_id:`interactive-${Date.now()}`}),j("")}catch(g){console.error("Error generating response:",g),i("REALITY_GENERATION_ERROR: Unable to manifest vision")}finally{m(!1)}}};return e.jsxs("div",{className:"interactive-dadacat-section",children:[e.jsxs("form",{onSubmit:N,className:"prompt-form",children:[e.jsxs("div",{className:"prompt-input-container",children:[e.jsx("input",{type:"text",value:r,onChange:c=>j(c.target.value),placeholder:"> ENTER YOUR VISION FOR DADACAT...",className:"prompt-input",disabled:d,maxLength:200}),e.jsx("button",{type:"submit",className:"generate-button",disabled:!r.trim()||d,children:d?"MANIFESTING...":"MANIFEST"})]}),u&&e.jsx("div",{className:"error-message",style:{marginTop:"10px"},children:u})]}),d&&e.jsx("div",{className:"generating-status",children:e.jsxs("div",{className:"terminal-window",style:{marginTop:"20px"},children:[e.jsxs("div",{className:"terminal-header",children:["> CONSULTING DADACAT...",e.jsx("br",{}),"> TRANSLATING VISION TO REALITY...",e.jsx("br",{}),"> GENERATING MANIFESTATION..."]}),e.jsx("div",{className:"terminal-body",children:e.jsx("div",{className:"loading",children:"PROCESSING GNOSIS"})})]})})]})}function D(){const[n,r]=t.useState(null),[j,d]=t.useState(!1),[m,u]=t.useState(null),[i,N]=t.useState("browse"),c=o=>{r(o),d(!1);const p=o.cleaned_prompt.length,S=Math.max(8e3,Math.min(12e3,p*40));u(S);const A=document.getElementById("gnosisLevel");A&&(A.textContent="0%")},g=()=>{d(!0)};return e.jsxs("div",{className:"art-viewer-container",children:[e.jsxs("header",{className:"art-viewer-header",children:[e.jsx("h1",{className:"glitch",children:"DADACAT_VIEWER"}),e.jsx("p",{className:"error-message",children:"WARNING: DadaCat visions only"})]}),e.jsxs("div",{className:"mode-selector",children:[e.jsx("button",{className:`mode-button ${i==="browse"?"active":""}`,onClick:()=>N("browse"),children:"BROWSE VISIONS"}),e.jsx("button",{className:`mode-button ${i==="interactive"?"active":""}`,onClick:()=>N("interactive"),children:"MANIFEST VISION"})]}),i==="browse"?e.jsx(R,{onArtSelect:c}):e.jsx(_,{onGenerate:c}),e.jsxs("div",{className:"content-display",children:[e.jsx(I,{prompt:(n==null?void 0:n.cleaned_prompt)||null,syncDuration:m,onTypingComplete:g}),e.jsx(T,{imageUrl:n?n.image_url||`https://f005.backblazeb2.com/file/td-website/${n.backblaze_path}`:null,startReveal:n!==null,syncDuration:m})]}),e.jsxs("nav",{className:"error-nav",style:{textAlign:"center",marginTop:"40px"},children:[e.jsx("a",{href:"/",className:"error-link",children:"[RETURN_TO_404]"}),e.jsx("a",{href:"/pages/gallery.html",className:"error-link",children:"[BROWSE_GALLERY]"}),e.jsx("a",{href:"/pages/poems.html",className:"error-link",children:"[ALL_VISIONS]"})]})]})}v.createRoot(document.getElementById("react-root")).render(e.jsx(E.StrictMode,{children:e.jsx(D,{})}));
