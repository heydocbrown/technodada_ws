import{r as s,j as e,c as p}from"./App-BiV6oCY1.js";import{T as R}from"./ThumbnailSelector-D2cdcWOr.js";function L({prompt:t,imageUrl:a,startOverlay:o}){const[n,d]=s.useState(!1),[m,i]=s.useState(0),[h,I]=s.useState(1),[y,g]=s.useState(100),[x,v]=s.useState(!1),E=s.useRef(null),l=s.useRef(null);s.useEffect(()=>{t&&a&&(d(!1),i(0),g(100),v(!1),l.current&&clearInterval(l.current))},[t,a]),s.useEffect(()=>{if(o&&n&&m>0&&!x){v(!0);const r=document.getElementById("gnosisLevel");return r&&(r.textContent="0%"),setTimeout(()=>{let c=100;const j=7e3/100;l.current=setInterval(()=>{if(c-=1,c<=0){c=0,clearInterval(l.current);const u=document.getElementById("gnosisLevel");u&&(u.textContent="100%")}g(c);const f=document.getElementById("gnosisLevel");if(f){const u=Math.round(100-c);f.textContent=u+"%"}},j)},3e3),()=>{l.current&&clearInterval(l.current)}}},[o,n,m,x]);const N=r=>{d(!0),i(r.target.naturalHeight),I(r.target.naturalWidth/r.target.naturalHeight)};return!t&&!a?null:e.jsx("div",{className:"overlay-section",children:e.jsxs("div",{className:"terminal-window",children:[e.jsx("div",{className:"terminal-header",children:"> INITIATING REALITY_FUSION..."}),e.jsx("div",{className:"overlay-viewer",children:e.jsxs("div",{className:"overlay-container",style:{minHeight:n?`${600/h}px`:"500px",maxHeight:"700px"},children:[e.jsxs("div",{className:"overlay-text",children:["> ",e.jsx("span",{dangerouslySetInnerHTML:{__html:(t==null?void 0:t.replace(/\n/g,"<br/>"))||""}})]}),a&&n&&e.jsx("img",{ref:E,src:a,alt:"REALITY_OVERLAY",className:"overlay-image",style:{display:"block",clipPath:`inset(0 0 ${y}% 0)`}}),a&&!n&&e.jsx("img",{src:a,alt:"PRELOAD",onLoad:N,style:{display:"none"}}),a&&!n&&e.jsxs("div",{className:"overlay-text",style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",backgroundColor:"var(--gray-1)",zIndex:10},children:["> LOADING VISUAL_OVERLAY",e.jsx("br",{}),"> PREPARING FUSION_SEQUENCE"]})]})})]})})}function S(){const[t,a]=s.useState(null),[o,n]=s.useState(!0),d=m=>{a(m),n(!1);const i=document.getElementById("gnosisLevel");i&&(i.textContent="0%"),setTimeout(()=>{const h=window.pageYOffset||document.documentElement.scrollTop;n(!0),setTimeout(()=>{window.scrollTo({top:h,behavior:"instant"})},0)},11e3)};return e.jsxs("div",{className:"art-viewer-container",children:[e.jsxs("header",{className:"art-viewer-header",children:[e.jsx("h1",{className:"glitch",children:"TECHNODADA_FUSION"}),e.jsx("p",{className:"error-message",children:"WARNING: Reality layers may merge unexpectedly"})]}),t&&e.jsx("div",{className:"content-display",children:e.jsx(L,{prompt:(t==null?void 0:t.cleaned_prompt)||null,imageUrl:t?`https://f005.backblazeb2.com/file/td-website/${t.backblaze_path}`:null,startOverlay:t!==null})}),e.jsx(R,{onArtSelect:d,isVisible:o}),e.jsxs("nav",{className:"error-nav",style:{textAlign:"center",marginTop:"40px"},children:[e.jsx("a",{href:"/",className:"error-link",children:"[RETURN_TO_404]"}),e.jsx("a",{href:"/pages/poems.html",className:"error-link",children:"[TEXT_VIEWER]"}),e.jsx("a",{href:"/pages/poem2.html",className:"error-link",children:"[GALLERY_VIEWER]"}),e.jsx("a",{href:"/pages/gallery.html",className:"error-link",children:"[BROWSE_GALLERY]"}),e.jsx("a",{href:"/pages/tools.html",className:"error-link",children:"[ACCESS_TOOLS]"})]})]})}p.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(S,{})}));
